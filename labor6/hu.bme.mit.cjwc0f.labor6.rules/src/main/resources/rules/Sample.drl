package com.sample
 
import com.sample.DroolsTest.Message;
import hu.bme.mit.cjwc0f.events.StudyWaitsForJoin;
import hu.bme.mit.cjwc0f.events.SocialWaitsForJoin;
import hu.bme.mit.cjwc0f.events.Joined;
import hu.bme.mit.cjwc0f.events.AssignRoomChosen;
import hu.bme.mit.cjwc0f.events.DetFinalResultChosen;
 
declare Joined
	@role(event)
	@expires(25s)
end  
declare StudyWaitsForJoin
	@role(event)
end 
declare SocialWaitsForJoin
	@role(event)
end 
declare AssignRoomChosen
	@role(event)
	@expires(25s)
end 
declare DetFinalResultChosen
	@role(event)
	@expires(25s)
end 

rule "StudyWaitsForSocial"
    when
        $studyWFJ : StudyWaitsForJoin($studyTS : timestamp)
        $social : SocialWaitsForJoin(timestamp == $studyTS, this after[10s] $studyWFJ)
    then
        System.out.println( "The social branch of the process instance with id( " + $studyTS + " ) was not complete within 10 seconds from the completion of the study branch." );
        retract($studyWFJ);
        retract($social);
end

rule "SocialWaitsForStudy"
    when
        $socialWFJ : SocialWaitsForJoin($socialTS : timestamp)
        $study : StudyWaitsForJoin(timestamp == $socialTS, this after[10s] $socialWFJ)
    then
        System.out.println( "The study branch of the process instance with id( " + $socialTS + " ) was not complete within 10 seconds from the completion of the social branch." );
        retract($socialWFJ);
        retract($study);
end
